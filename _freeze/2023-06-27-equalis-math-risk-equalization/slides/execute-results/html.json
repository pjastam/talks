{
  "hash": "e7f33440693e2ea1cc865f8a6a4f0926",
  "result": {
    "markdown": "---\ntitle: \"The math of risk equalization\"\nsubtitle: \"June 27th, 2023\"\nauthor: \"Piet Stam\"\nformat: \n  revealjs:\n    theme: dark\n    transition: slide\n    reference-location: document\n    mainfont: Calibri\nexecute:\n  echo: false\neditor: source\n---\n\n\n## Meet & greet\n\n::: incremental\n-   What do you expect to learn from this course?\n-   My agenda\n    -   First, an intro to the math\n    -   Second, applying it to some data\n-   R package `rvedata` based on my PhD thesis\n:::\n\n## Context\n\n::: columns\n::: {.column width=\"40%\"}\n[![](img/escher-report-2022.png){fig-alt=\"Voorpagina van EsCHER-rapport\" width=\"100%\" height=\"100%\"}](https://www.eur.nl/en/media/2022-11-2022014-kleef-et-al)\n:::\n\n::: {.column width=\"60%\"}\n::: incremental\n-   ðŸ‡³ðŸ‡± health care (basic benefits)\n-   ðŸ‡³ðŸ‡± health insurance\n-   ðŸ‡³ðŸ‡± system of risk equalization\n-   Traditional focus on incentives\n    -   **NOT** actual behavior\n    -   **NOT** effects (efficiency & equity)\n:::\n:::\n:::\n\n## Data collection\n\n::: columns\n::: {.column width=\"40%\"}\n\n{{< fa solid database size=7x >}}\n\n\n:::\n\n::: {.column width=\"60%\"}\n::: incremental\n-   Large national data set\n-   Population vs. sample\n-   Weights for insurance period\n-   Multiple records per insured\n-   Pseudonyms for merging data sets\n:::\n:::\n:::\n\n## Which are the \"acceptable costs\"?\n\n\"The costs of services that follow from a quality, intensity and price level of treatment *that the sponsor considers to be acceptable to be subsidized*.\" (Van de Ven and Ellis, 2000)\n\n::: columns\n::: {.column width=\"40%\"}\n\n{{< fa solid euro-sign size=7x >}}\n\n\n:::\n\n::: {.column width=\"60%\"}\n::: incremental\n-   Two extremes:\n\n    -   Best practice costs\n    -   Actual expenditures\n\n-   Q: which is more health based?\n\n-   ðŸ‡³ðŸ‡±: Y = actual expenditures with average prices for some services\n:::\n:::\n\n::: notes\n-   Q: with this definition, is Y health based?\n-   A: no, it is production based\n-   I: therefore, compensation can hardly be made health-based\n:::\n:::\n\n## Which subgroups to compensate?\n\n::: columns\n\"The REF equation should only include parameters which equalize cost differences in health status of an insured *as a consequence of differences in age, gender and other objective measures of health status.*\" (Health Insurance Decree:389, p.23)\n\n::: {.column width=\"50%\"}\n*Compensation* forÂ **S**(olidarity)-type groups\n\n::: incremental\n-   Age\n-   Gender\n-   Health status\n:::\n:::\n\n::: {.column width=\"50%\"}\n*No compensation* for\\\n**N**(on-solidarity)-type groups\n\n::: incremental\n-   Propensity to consume\n-   Input prices\n-   Regional overcapacity (SID)\n-   Provider practice style\n:::\n:::\n:::\n\n## The regression equation\n\n$$\n\\begin{aligned}\n  Y &= f(S,N) + u \\\\\n    &= S \\alpha + N \\gamma + u \\\\\n    &= \\sum_{l=1}^L S_l \\alpha_l + \\sum_{m=1}^M N_m \\gamma_m + u\n\\end{aligned}\n$$\n\nwith\n\n-   $Y$ health expenses observed during some period in time\n-   $S_l$ is the $l$th **S**-type risk factor, $l=1,...,L$\n-   $N_m$ is the $m$th **N**-type risk factor, $m=1,...,M$\n-   ($u \\sim IID(0,1)$)\n\n::: notes\n-   Q: why IID condition between brackets?\n-   A: because it is not needed to apply OLS\n-   I: it is only needed if you need standard errors\n:::\n\n## Which causal diagram?\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](slides_files/figure-revealjs/unnamed-chunk-1-1.png){width=960}\n:::\n:::\n\n\n::: notes\nSituation 1: more supply (N) -\\> more Y Situation 2: more supply (N) -\\> more Y, better health Situation 2: too much supply (N) -\\> worse health b/o over treatment Situation 3: sick people (H) -\\> move to more/better supply in big cities (N)\n:::\n\n## Big assumption\n\n::: columns\n::: {.column width=\"40%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](slides_files/figure-revealjs/unnamed-chunk-2-1.png){width=960}\n:::\n:::\n\n:::\n\n::: {.column width=\"60%\"}\nDefine $v := N \\gamma + u$ and rewrite\n$$\n\\begin{aligned}\n  Y &= S \\alpha + N \\gamma + u \\iff \\\\\n  Y &= S \\alpha + v\n\\end{aligned}\n$$\n\n$$\n\\begin{aligned}\n  \\implies \\hat{\\alpha} &= (S'S)^{-1}S'Y \\\\\n               &= (S'S)^{-1}S'(S \\alpha + v) \\\\\n               &= \\alpha + (S'S)^{-1}S'N\\gamma + (S'S)^{-1}S'u\n\\end{aligned}\n$$\n\n$$\n\\implies E[\\hat{\\alpha} | S,N ] = \\alpha \\iff \\begin{aligned} \\begin{cases} S'N = 0 \\\\ \\gamma = 0 \\end{cases} \\end{aligned}\n$$\n:::\n:::\n\n## What to do if assumption fails?\n\n::: columns\n::: {.column width=\"40%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](slides_files/figure-revealjs/unnamed-chunk-3-1.png){width=960}\n:::\n:::\n\n:::\n\n::: {.column width=\"60%\"}\nSchokkaert and Van de Voorde () recommend a 2-step method:\n\n1.  estimate ($\\alpha, \\gamma)$ in regression with $S$ and $N$ variables\n2.  predict $Y$ with $N$ set at prevalences\n\nThe formula then reads as follows:\n\n$$\n\\hat{Y} = S \\hat{\\alpha} + \\overline{N} \\hat{\\gamma}\n$$ with $\\overline{N}$ being a row i/o matrix.\n:::\n:::\n\n## Or... ignore this omitted vars bias {{< fa surprise >}}\n\nIn practice, we apply this equation:\n\n$$Y = X \\beta + \\epsilon$$\n\nand try to extend $X$ with as much (measurable) **S**-type variables as possible.\n\n## Regression without an intercept\n\n:::: columns\n\n::: {.column width=\"50%\"}\n::: incremental\nTraditional OLS:\n\n  - include an intercept\n  - omit one category of age/gender\n  - omit one category of each other $X$ (which one?)\n:::\n:::\n\n::: {.column width=\"50%\"}\n::: incremental\nOLS w/ risk equalization:\n\n  - *do not* include an intercept\n  - include *all categories* of all other $X$'s\n  - set total effect of age/gender := sum of $Y$\n  - set total effect of each other $X$ := 0\n:::\n:::\n\n::::\n\n## Apply weights\n\n::: incremental\n-   Weights $W$ define length of insurance contract\n-   $0 < W <= 1$\n-   Potential reasons for $W < 1$:\n    -   2 or more records for 1 individual -\\> sum Y and X\n    -   babies born\n    -   people deceased\n:::\n\n## Use aggregation to save computer time\n\n::: incremental\n- \"Vertical aggregation\" for each unique combination of X\n- Total number of rows = number of unique combinations\n- W := sum of observations for each unique combination \n- Y := average expenses $\\overline{Y}$ for each unique combination\n- X := set of prevalences $\\overline{X}$ for each unique combination\n- OLS estimation using these W, Y and X\n- Bekijk [mijn blog](https://www.pietstam.nl/posts/2023-02-26-ols-estimates-aggregate-data/) voor een eenvoudig voorbeeld\n:::\n\n## Region: individual & zip code data\n\n-   In 2002 a two-step approach was implemented:\n    - step 1: $Y = X \\beta + \\epsilon$ (*indiv. level*)\n    - step 2: $\\epsilon = Z*c + \\xi$   (*zip-code level*)\n-   As $\\hat{\\epsilon} = Y - \\hat{Y}$ step 2 can be read as:\n    - step 2: $Y = 1.\\hat{Y} + Z*c + \\xi$\n-   Implicit restriction: $\\hat{Y}$ and $Z$ not correlated\n-   If this assumption is false, the estimators are inconsistent\n-   Therefore, $\\hat{Y}$ was added to step 2 since the 2006 model\n-   Nowadays, one comprehensive regression at *indiv. level*\n\n## (Ex post) risk sharing\n\nDefinition: insurers are retrospectively reimbursed for some of the costs of some of their insurance members (Van de Ven and Ellis 2000)\n\n![](img/barneveld-risk-sharing.png){fig-alt=\"Table risk sharing methods\" width=\"100%\" height=\"100%\"}\n\n## Assessment framework\n\n![](img/assessment_measures_OT2022.png){fig-alt=\"Table assessment framework\" width=\"75%\" height=\"75%\"}\n\n## Install package `rvedata`\n\n-   Source: [https://github.com/risicoverevening/rvedata](https://github.com/risicoverevening/rvedata)\n\n-   Metadata `rvedata`\n\n    ![](img/table_risk_adjusters.png)\n\n\n------------------------------------------------------------------------\n\n::: {style=\"text-align: center; position: relative; top: 30%\"}\n<https://pietstam.nl/talks>\n:::\n\n::: footer\nDe inhoud van deze slides is beschikbaar onder de [Creative Commons Naamsvermelding-GelijkDelen 4.0 Internationaal](https://creativecommons.org/licenses/by-sa/4.0/) licentie.\n\nDe broncode voor het genereren van deze slides is beschikbaar op [GitHub](https://github.com/pjastam/talks) onder de [MIT licentie](https://github.com/pjastam/blog-quarto/blob/main/LICENSE.md).\n\nCopyright (c) 2023 [Piet Stam](https://www.pietstam.nl).\n:::\n",
    "supporting": [
      "slides_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\r\n<script>\r\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\r\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\r\n  // slide changes (different for each slide format).\r\n  (function () {\r\n    // dispatch for htmlwidgets\r\n    function fireSlideEnter() {\r\n      const event = window.document.createEvent(\"Event\");\r\n      event.initEvent(\"slideenter\", true, true);\r\n      window.document.dispatchEvent(event);\r\n    }\r\n\r\n    function fireSlideChanged(previousSlide, currentSlide) {\r\n      fireSlideEnter();\r\n\r\n      // dispatch for shiny\r\n      if (window.jQuery) {\r\n        if (previousSlide) {\r\n          window.jQuery(previousSlide).trigger(\"hidden\");\r\n        }\r\n        if (currentSlide) {\r\n          window.jQuery(currentSlide).trigger(\"shown\");\r\n        }\r\n      }\r\n    }\r\n\r\n    // hookup for slidy\r\n    if (window.w3c_slidy) {\r\n      window.w3c_slidy.add_observer(function (slide_num) {\r\n        // slide_num starts at position 1\r\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\r\n      });\r\n    }\r\n\r\n  })();\r\n</script>\r\n\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}